{{> header}}

<div itemscope itemtype="http://schema.org/Dataset">
    <h1 itemprop="name">{{dataset.name}}</h1>
    <span itemprop="description">{{dataset.description}}</span>
    <br/>
    <br/>
    <dl class="dl-horizontal dl-horizontal-space">
        <dt>Keywords</dt>
        <dd>
            <span itemprop="keywords">
                <ul class="list-comma-separated">
                    {{#dataset.keywords}}
                        <li>{{.}}</li>
                    {{/dataset.keywords}}
                </ul>
            </span>
        </dd>
        <dt>Extent</dt>
        <dd>
            <span itemprop="spatial" itemscope itemtype="http://schema.org/Place">
                <span itemprop="geo" itemscope itemtype="http://schema.org/GeoShape">
                    <span itemprop="box">{{dataset.bbox}}</span>
                </span>
            </span>
        </dd>
    </dl>

</div>

<div class="row">
    <div class="col-md-6">

        {{> pagination}}

        <ul class="list-unstyled">
            {{#features}}
                <li>
                    {{> feature}}
                </li>
            {{/features}}
        </ul>

        {{> pagination}}

    </div>
    <div class="col-md-6">
        <div id="map"></div>
        <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script type="text/javascript">
            var osmTiles = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
            });
            var geoJsonUrl = '?f=json&';
            if (window.location.href.indexOf('?') > 0) {
                geoJsonUrl += window.location.href.slice(window.location.href.indexOf('?') + 1);
            }
            var map = L.map('map');

            $.getJSON(geoJsonUrl, function(data) {
                var geoJson = L.geoJson(data, {
                    onEachFeature: function (feature, layer) {
                        if (feature.geometry.type != 'Point') {
                            layer.bindPopup(feature.id);
                            L.marker(layer.getBounds().getCenter(), {title: feature.id}).addTo(map);
                        }
                    },
                    pointToLayer: function (feature, latlng) {
                        return L.marker(latlng, {title: feature.id}).addTo(map);
                    }
                });
                map.fitBounds(geoJson.getBounds(), {
                    padding: [50, 50],
                    maxZoom: 16
                });
                osmTiles.addTo(map);
                geoJson.addTo(map);
            });




        </script>
    </div>
</div>

{{> footer}}